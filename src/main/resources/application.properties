spring.application.name=dag-execution-engine
server.port=8999

spring.batch.job.enabled=false
spring.batch.jdbc.initialize-schema=always

spring.datasource.url=jdbc:h2:file:./data/batch-meta;AUTO_SERVER=TRUE
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

logging.level.org.springframework.batch=INFO
logging.level.com.workflow.engine=DEBUG

# =============================================================================
# WORKFLOW ENGINE SETTINGS
# =============================================================================
# For production, set ALL strict* and require* to true for Ab Initio-grade safety

# Compiler Settings (ExecutionGraphBuilder)
# strictJoins=true: FAIL if FORK has no explicit joinNodeId
# allowJoinInference=false: Do not auto-infer join nodes (runtime guessing disabled)
workflow.compiler.strictJoins=false
workflow.compiler.allowJoinInference=true

# Validator Settings (ExecutionPlanValidator)
# strictJoins=true: Any node with >1 incoming edges must be JOIN/BARRIER
# strictJoinUpstreams=true: JOIN's upstreamSteps must exactly match actual incomers
# requireExplicitJoin=true: FORK without explicit joinNodeId is ERROR
workflow.validation.strictJoins=false
workflow.validation.strictJoinUpstreams=false
workflow.validation.requireExplicitJoin=false

# Error Routing Policy
# FAIL: Mark job as FAILED after error steps
# STOP: Stop execution but don't mark failed
# COMPENSATE_AND_FAIL: Run compensation steps then FAIL
# COMPENSATE_AND_COMPLETE: Run compensation steps then COMPLETE
workflow.error.policy=FAIL

# Job Naming
workflow.job.require-workflow-id=true

# Thread Pool Configuration
workflow.executor.core-pool-size=4
workflow.executor.max-pool-size=16
workflow.executor.queue-capacity=100
workflow.executor.thread-name-prefix=wf-
workflow.executor.await-termination-seconds=60
